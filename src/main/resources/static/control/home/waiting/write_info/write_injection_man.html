<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <title>注射泵质量检测原始记录</title>
    <link rel="stylesheet" type="text/css" href="../../../../static/layui/css/layui.css"/>
    <link rel="stylesheet" type="text/css" href="../../../../static/css/admin.css"/>
    <link rel="stylesheet" href="../../../../static/css/all.min.css"/>
    <script type="text/javascript" src="../../../../static/js/jquery-3.3.1.min.js"></script>
    <script src="../../../../static/layui/layui.js" type="text/javascript" charset="utf-8"></script>
    <script src="injection_man.js"></script>
    <!--[if IE 8]>
    <script type="text/javascript" src="../../../../static/js/jquery-1.11.3.min.js"></script>
    <![endif]-->
    <style>
        .layui-elem-field {
            width: 100%;
        }

        .btn {
            text-align: center;
            margin-top: 70px;
            margin-bottom: 40px;
        }

        .layui-input-block {
            display: flex;
            align-items: center;
        }

        b {
            padding-left: 30px;
            width: 20%;
        }

        .is {
            color: green;
        }

        .no {
            color: red;
        }
    </style>
</head>
<body>
<div class="layui-row">
    <p style="height: 34px;width: 100%;line-height: 34px;background-color: lightyellow; text-align: center;"><span class="sign">***</span>请认真填写数据信息<span class="sign">***</span></p>
    <div class="col-xs-12">
        <fieldset class="layui-elem-field layui-field-title">
            <legend style="font-size: 22px;font-weight: bold;">注射泵质量检测原始记录(成人)</legend>
        </fieldset>
        <form class="layui-form layui-form-pane" action="">
            <fieldset class="layui-elem-field layui-field-title">
                <legend style="color: red;">流量检测</legend>
            </fieldset>
            <div class="group_llcsd5">
                <fieldset class="layui-elem-field layui-field-title">
                    <legend style="color: #555555;">流量测试点 —— <span class="sign">5 ml/h</span></legend>
                </fieldset>
                <div class="layui-form-item col-md-6 col-xs-12">
                    <label class="layui-form-label">测试值1</label>
                    <div class="layui-input-block">
                        <input type="text" id="lljcCsz1" name="lljcCsz1" placeholder="测试值1" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-6 col-xs-12">
                    <label class="layui-form-label">测试值2</label>
                    <div class="layui-input-block">
                        <input type="text" id="lljcCsz2" name="lljcCsz2" placeholder="测试值2" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-6 col-xs-12">
                    <label class="layui-form-label">测试值3</label>
                    <div class="layui-input-block">
                        <input type="text" id="lljcCsz3" name="lljcCsz3" placeholder="测试值3" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-6 col-xs-12">
                    <label class="layui-form-label">平均值</label>
                    <div class="layui-input-block">
                        <input type="text" id="lljcPjz1" name="lljcPjz1" placeholder="平均值" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-6 col-xs-12">
                    <label class="layui-form-label">误差</label>
                    <div class="layui-input-block">
                        <input type="text" id="lljcWcz1" name="lljcWcz1" readonly placeholder="误差" autocomplete="off" class="layui-input" value="±6%">
                        <b class="mp"></b>
                        <input type="hidden" name="lljcResult1">
                    </div>
                </div>
            </div>
            <div class="group_llcsd25">
                <fieldset class="layui-elem-field layui-field-title">
                    <legend style="color: #555555;">流量测试点 —— <span class="sign">25 ml/h</span></legend>
                </fieldset>
                <div class="layui-form-item col-md-6 col-xs-12">
                    <label class="layui-form-label">测试值1</label>
                    <div class="layui-input-block">
                        <input type="text" id="lljcCsz4" name="lljcCsz4" placeholder="测试值1" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-6 col-xs-12">
                    <label class="layui-form-label">测试值2</label>
                    <div class="layui-input-block">
                        <input type="text" id="lljcCsz5" name="lljcCsz5" placeholder="测试值2" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-6 col-xs-12">
                    <label class="layui-form-label">测试值3</label>
                    <div class="layui-input-block">
                        <input type="text" id="lljcCsz6" name="lljcCsz6" placeholder="测试值3" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-6 col-xs-12">
                    <label class="layui-form-label">平均值</label>
                    <div class="layui-input-block">
                        <input type="text" id="lljcPjz2" name="lljcPjz2" placeholder="平均值" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-6 col-xs-12">
                    <label class="layui-form-label">误差</label>
                    <div class="layui-input-block">
                        <input type="text" id="lljcWcz2" name="lljcWcz2" placeholder="误差" value="±5%" autocomplete="off" readonly class="layui-input">
                        <b class="mp"></b>
                        <input type="hidden" name="lljcResult2">
                    </div>
                </div>
            </div>
            <fieldset class="layui-elem-field layui-field-title">
                <legend style="color: red;">阻塞报警检测 —— 测试流量: 25ml/h</legend>
            </fieldset>
            <div class="group_zsbj">
                <fieldset class="layui-elem-field layui-field-title">
                    <legend style="color: #555555;">使用压力值</legend>
                </fieldset>
                <div class="layui-form-item col-md-5 col-xs-12">
                    <label class="layui-form-label">使用压力值</label>
                    <div class="layui-input-block">
                        <input type="text" id="zsbjyljcSyylz" name="zsbjyljcSyylz" placeholder="使用压力值" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-5 col-xs-12">
                    <label class="layui-form-label">测试值</label>
                    <div class="layui-input-block">
                        <input type="text" id="zsbjyljcCsz1" name="zsbjyljcCsz1" placeholder="测试值" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-5 col-xs-12">
                    <label class="layui-form-label">误差</label>
                    <div class="layui-input-block">
                        <input type="text" id="zsbjyljcWcz1" name="zsbjyljcWcz1" readonly value="±100或±30%" placeholder="误差" autocomplete="off" class="layui-input">
                        <b class="mp"></b>
                        <input type="hidden" name="lljcResult1">
                    </div>
                </div>
            </div>
            <div class="group_zsbj">
                <fieldset class="layui-elem-field layui-field-title">
                    <legend style="color: #555555;">最小压力值</legend>
                </fieldset>
                <div class="layui-form-item col-md-5 col-xs-12">
                    <label class="layui-form-label">最小压力值</label>
                    <div class="layui-input-block">
                        <input type="text" id="zsbjyljcZxylz" name="zsbjyljcZxylz" placeholder="最小压力值" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-5 col-xs-12">
                    <label class="layui-form-label">测试值</label>
                    <div class="layui-input-block">
                        <input type="text" id="zsbjyljcCsz2" name="zsbjyljcCsz2" placeholder="测试值" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-5 col-xs-12">
                    <label class="layui-form-label">误差</label>
                    <div class="layui-input-block">
                        <input type="text" id="zsbjyljcWcz2" name="zsbjyljcWcz2" readonly value="±100或±30%" placeholder="误差" autocomplete="off" class="layui-input">
                        <b class="mp"></b>
                    </div>
                </div>
            </div>
            <div class="group_zsbj">
                <fieldset class="layui-elem-field layui-field-title">
                    <legend style="color: #555555;">最大压力值</legend>
                </fieldset>
                <div class="layui-form-item col-md-5 col-xs-12">
                    <label class="layui-form-label">最大压力值</label>
                    <div class="layui-input-block">
                        <input type="text" id="zsbjyljcZdylz" name="zsbjyljcZdylz" placeholder="最大压力值" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-5 col-xs-12">
                    <label class="layui-form-label">测试值</label>
                    <div class="layui-input-block">
                        <input type="text" id="zsbjyljcCsz3" name="zsbjyljcCsz3" placeholder="测试值" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item col-md-5 col-xs-12">
                    <label class="layui-form-label">误差</label>
                    <div class="layui-input-block">
                        <input type="text" id="zsbjyljcWcz3" name="zsbjyljcWcz3" readonly value="±100或±30%" placeholder="误差" autocomplete="off" class="layui-input">
                        <b class="mp"></b>
                    </div>
                </div>
            </div>
            <input type="hidden" name="zsbjyljcResult">
            <fieldset class="layui-elem-field layui-field-title">
                <legend style="color: red;">报警系统检测</legend>
            </fieldset>
            <fieldset class="layui-elem-field layui-field-title">
                <legend style="color: #555555;">开门报警</legend>
            </fieldset>
            <div class="layui-form-item col-md-4">
                <label class="layui-form-label">开门报警</label>
                <div class="layui-input-block" style="border: 1px solid #CCCCCC;">
                    <input type="radio" name="kmbj" value="1" title="符合" checked>
                    <input type="radio" name="kmbj" value="2" title="不符合">
                </div>
            </div>
            <fieldset class="layui-elem-field layui-field-title">
                <legend style="color: #555555;">输液完毕报警</legend>
            </fieldset>
            <div class="layui-form-item col-md-4">
                <label class="layui-form-label">输液完毕报警</label>
                <div class="layui-input-block" style="border: 1px solid #CCCCCC;">
                    <input type="radio" name="sywbbj" value="1" title="符合" checked>
                    <input type="radio" name="sywbbj" value="2" title="不符合">
                </div>
            </div>
            <fieldset class="layui-elem-field layui-field-title">
                <legend style="color: #555555;">电源线脱落报警</legend>
            </fieldset>
            <div class="layui-form-item col-md-4">
                <label class="layui-form-label">电源线脱落报警</label>
                <div class="layui-input-block" style="border: 1px solid #CCCCCC;">
                    <input type="radio" name="dyxtlbj" value="1" title="符合" checked>
                    <input type="radio" name="dyxtlbj" value="2" title="不符合">
                </div>
            </div>
            <fieldset class="layui-elem-field layui-field-title">
                <legend style="color: #000000;font-weight: bold;">检测人信息</legend>
            </fieldset>
            <div class="layui-form-item col-md-4">
                <label class="layui-form-label">检测人</label>
                <div class="layui-input-block">
                    <input id="isUser" type="text" disabled name="tester" required autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item col-md-4">
                <label class="layui-form-label">检测时间</label>
                <div class="layui-input-block">
                    <input id="date" type="text" name="testTime" required autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item layui-form-text col-md-6">
                <label class="layui-form-label">检测情况说明</label>
                <div class="layui-input-block">
                    <textarea name="jcsm" placeholder="请输入内容" class="layui-textarea"></textarea>
                </div>
            </div>
            <div class="layui-form-item btn">
                <div class="layui-input-block">
                    <button class="layui-btn js-save" lay-submit lay-filter="saveAll">保存</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script>
    // 获取上个页面传递的类型
    var type = window.location.search;
    var ids = parseInt(type.split("=")[1]);
    sessionStorage["thisjcyqId"] = ids;
    var thiseqId = parseInt(sessionStorage['thiseqId']);
    var userName = sessionStorage["userName"];
    var thisId = parseInt(sessionStorage['thisId']);


    //设置结果
    $(".js-save").on("click", function () {
        settingResult();
    })

    function settingResult() {
        //心率
        //流量测试点 —— 5 ml/h
        var llcsd5ResultPass = true;
        $(".group_llcsd5 .mp").each(function () {
            if ($(this).is(".no")) {
                llcsd5ResultPass = false;
            }
        });
        $("input[name='lljcResult1']").val(llcsd5ResultPass ? "合格" : "不合格");
        //流量测试点 —— 25 ml/h
        var llcsd25ResultPass = true;
        $(".group_llcsd25 .mp").each(function () {
            if ($(this).is(".no")) {
                llcsd25ResultPass = false;
            }
        });
        $("input[name='lljcResult2']").val(llcsd25ResultPass ? "合格" : "不合格");
        //阻塞报警压力检测
        var zsylbjResultPass = true;
        $(".group_zsbj .mp").each(function () {
            if ($(this).is(".no")) {
                zsylbjResultPass = false;
            }
        });
        $("input[name='zsbjyljcResult']").val(zsylbjResultPass ? "合格" : "不合格");
    };

    layui.use(['element', 'jquery', 'form', 'layer', 'laydate'], function () {
        var element = layui.element
            , $ = layui.jquery
            , form = layui.form
            , layer = layui.layer
            , laydate = layui.laydate;
        $(function () {
            $("#isUser").val(userName);
        });
        laydate.render({
            elem: "#date",
            type: "datetime"
        });
        // 成人
        form.on("submit(saveAll)", function (data) {
            console.log(data.field);
            $.ajax({
                url: "/zsb/save?eqId=" + thiseqId + "&jcyqId=" + ids + "&userEqId=" + thisId,
                method: "POST",
                data: data.field,
                dataType: "JSON",
                success: function (res) {
                    if (res.state === 200) {
                        sessionStorage["thissjId"] = res.data[1];
                        setTimeout(function () {
                            location.href = "/control/home/waiting/wait_info/injection_pump_man.html?id=" + res.data[0];
                        }, 1000);
                        layer.msg("保存成功,正在生成表格");
                    } else {
                        layer.msg("提交失败");
                    }
                },
                error: function (data) {
                    layer.msg("请稍后再试");
                    console.log(data);
                }
            });
            return false;
        });
    });
</script>
</body>
</html>