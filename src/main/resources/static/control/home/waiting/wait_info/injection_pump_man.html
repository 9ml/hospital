<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <title>注射泵质量检测原始记录表</title>
    <link rel="stylesheet" type="text/css" href="../../../../static/layui/css/layui.css"/>
    <link rel="stylesheet" type="text/css" href="../../../../static/css/admin.css"/>
    <script src="../../../../static/js/jquery-3.3.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../../static/layui/layui.js" type="text/javascript" charset="utf-8"></script>
    <!--[if IE 8]>
    <script type="text/javascript" src="../../../../static/js/jquery-1.11.3.min.js"></script>
    <![endif]-->
    <script src="../../../../static/layui/layui.js"></script>
    <style>
        h2 {
            text-align: center;
            margin-top: 30px;
        }

        td {
            text-align: center;
        }

        .btn {
            width: 100%;
            margin-top: 50px;
            margin-bottom: 30px;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="layui-row">
    <div class="col-xs-12">
        <div class="col-xs-12">
            <fieldset class="layui-elem-field layui-field-title">
                <legend style="color: #000000;font-weight: bold;text-align: center;margin-bottom: 30px;">注射泵质量检测原始记录表</legend>
            </fieldset>
            <table class="layui-table">
                <tr>
                    <td rowspan="4">流量检测</td>
                    <td>设定值</td>
                    <td id="lljcSdz1" colspan="5"><!--25 ml/h--></td>
                    <td>允许误差<!--测试结果：允许测量误差±10％--></td>
                    <td>结果<!--测试结果：允许测量误差±10％--></td>
                </tr>
                <tr>
                    <td>三组测试值</td>
                    <td>1：</td>
                    <td>2：</td>
                    <td>3：</td>
                    <td>平均值：</td>
                    <td>误差：</td>
                    <td id="lljcWc1"><!--测试结果：允许测量误差±10％--></td>
                    <td>□合格□不合格<!--测试结果：允许测量误差±10％--></td>
                </tr>
                <tr>
                    <td></td>
                    <td colspan="5" id="lljcSdz2"></td>
                    <td>允许误差<!--测试结果：允许测量误差±10％--></td>
                    <td>□合格□不合格<!--测试结果：允许测量误差±10％--></td>
                </tr>
                <tr>
                    <td>三组测试值</td>
                    <td>1：</td>
                    <td>2：</td>
                    <td>3：</td>
                    <td>平均值：</td>
                    <td>误差：</td>
                    <td id="lljcWc2"><!--测试结果：允许测量误差±10％--></td>
                    <td>□合格□不合格<!--测试结果：允许测量误差±10％--></td>
                </tr>
                <tr>
                    <td rowspan="3">阻塞报警压力检测流速：<span id="zsbjyljcLs"></span></td>
                    <td>使用压力值</td>
                    <td></td>
                    <td>测试值</td>
                    <td>&nbsp;</td>
                    <td>误差</td>
                    <td></td>
                    <td>允许误差</td>
                    <td>结果</td>
                </tr>
                <tr>
                    <td>最小压力值</td>
                    <td></td>
                    <td>测试值</td>
                    <td>&nbsp;</td>
                    <td>误差</td>
                    <td></td>
                    <td rowspan="2" id="zsbjyljcWc"></td>
                    <td rowspan="2">□合格 □不合格</td>
                </tr>
                <tr>
                    <td>最大压力值</td>
                    <td></td>
                    <td>测试值</td>
                    <td>&nbsp;</td>
                    <td>误差</td>
                    <td></td>
                </tr>
                <tr>
                    <td colspan="2">开门报警</td>
                    <td>□符合 □不符合</td>
                    <td colspan="2">输液完毕报警</td>
                    <td>□符合 □不符合</td>
                    <td colspan="2">电源线脱落报警</td>
                    <td>□合格 □不合格</td>
                </tr>
            </table>
        </div>
        <fieldset class="layui-elem-field layui-field-title">
            <legend style="color: #000000;font-weight: bold;">检测人信息</legend>
        </fieldset>
        <table class="layui-hide" id="testerInfo"></table>
        <div class="col-xs-12 btn">
            <a id="update" class="layui-btn">修改</a>
        </div>
    </div>
</div>
<script type="text/html" id="toolbarDemo">
    <div class="layui-btn-container">
    </div>
</script>
<script>
    // 获取上个页面传递的类型
    var type = window.location.search;
    var ids = parseInt(type.split("=")[1]);
    var thissjId = parseInt(sessionStorage['thissjId']);
    var thisId = parseInt(sessionStorage['thisId']);
    var thiseqId = parseInt(sessionStorage['thiseqId']);
    var dqSb = sessionStorage['dqSb'];
    $(function () {
        sessionStorage['zsSb'] = 1;
        $.ajax({
            url: "/zsb/findByZsbid?zsbId=" + ids,
            method: "GET",
            dataType: "JSON",
            success: function (res) {
                console.log(res);
                if (res.data != null && res.data != "") {
                    // 流量检测
                    $("#pjll1").append(res.data.pjll1);
                    $("#pjll2").append(res.data.pjll2);
                    if (res.data.pjll1 >= 4.5 && res.data.pjll1 <= 5.5 && res.data.pjll2 >= 22.5 && res.data.pjll2 <= 27.5) {
                        $("#is1").append("<p style='color:green;'>符合</p>")
                    } else {
                        $("#is1").append("<p style='color:red;'>不符合</p>")
                    }
                    // 阻塞报警检测
                    $("#bjszH").append(res.data.bjszH);
                    $("#bjszM").append(res.data.bjszM);
                    $("#bjszL").append(res.data.bjszL);
                    $("#bjsjH").append(res.data.bjsjH);
                    $("#bjsjM").append(res.data.bjsjM);
                    $("#bjsjL").append(res.data.bjsjL);
                    $("#bjylH").append(res.data.bjylH);
                    $("#bjylM").append(res.data.bjylM);
                    $("#bjylL").append(res.data.bjylL);
                    if (res.data.bjylH >= (res.data.bjszH - res.data.bjszH * 0.2) && res.data.bjylH <= (res.data.bjszH + res.data.bjszH * 0.2) && res.data.bjylM >= (res.data.bjszM - res.data.bjszM * 0.2) && res.data.bjylM <= (res.data.bjszM + res.data.bjszM * 0.2) && res.data.bjylL >= 200 && res.data.bjylL <= 400) {
                        $("#is2").append("<p style='color:green;'>符合</p>")
                    } else {
                        $("#is2").append("<p style='color:red;'>不符合</p>")
                    }
                    // 单选
                    if (res.data.zs == 1) {
                        $("#zs").append("<p style='color: green;'>符合</p>");
                    } else {
                        $("#zs").append("<p style='color: red;'>不符合</p>");
                    }
                    if (res.data.jjkp == 1) {
                        $("#jjkp").append("<p style='color: green;'>符合</p>");
                    } else {
                        $("#jjkp").append("<p style='color: red;'>不符合</p>");
                    }
                    if (res.data.sygbt == 1) {
                        $("#sygbt").append("<p style='color: green;'>符合</p>");
                    } else {
                        $("#sygbt").append("<p style='color: red;'>不符合</p>");
                    }
                    if (res.data.dyxtk == 1) {
                        $("#dyxtk").append("<p style='color: green;'>符合</p>");
                    } else {
                        $("#dyxtk").append("<p style='color: red;'>不符合</p>");
                    }
                    if (res.data.kmbj == 1) {
                        $("#kmbj").append("<p style='color: green;'>符合</p>");
                    } else {
                        $("#kmbj").append("<p style='color: red;'>不符合</p>");
                    }
                } else {
                    layer.msg("无数据");
                }
            }
        })
    });
    //Demo
    layui.use(['table', 'layer', 'jquery', 'form'], function () {
        var table = layui.table
            , layer = layui.layer
            , $ = layui.jquery
            , form = layui.form;
        table.render({
            elem: "#testerInfo",
            cellMinWidth: 100,
            toolbar: '#toolbarDemo',
            url: "/zsb/findByZsbid?zsbId=" + ids,
            method: "GET",
            response: {
                statusName: 'status'
                , statusCode: 200
                , msgName: 'hint'
                , countName: 'total'
                , dataName: 'data'
            },
            parseData: function (res) {
                console.log(res.data);
//                sessionStorage['lreqId'] = res.data.eqId;
                return {
                    "status": 200
                    , "msg": res.message
                    , "count": res.total
                    , "data": [res.data]
                }
            },
            cols: [[
                {field: 'tester', title: '检测人', align: 'center'},
                {field: 'testTime', title: '检测时间', align: 'center'},
                {field: 'jcsm', title: '检测情况说明', align: 'center'}
            ]]
        });
        // 修改
        $("#update").click(function () {
            location.href = "/control/home/waiting/update/write_injection_man.html?id=" + ids;
        });
        // 返回
        $("#back").click(function () {
            if (dqSb == 1) {
                location.href = "/control/home/home.html";
            } else {
                location.href = "/control/home/waiting/check_info.html?id=" + thiseqId;
            }
        })
    })
</script>
</body>

</html>